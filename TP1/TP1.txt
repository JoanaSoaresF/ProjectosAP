Attention:
- Do not edit this file in text editors like Word. Use a plain text editor only. If in doubt you can use Spyder as a text editor.
- Do not change the structure of this file. Just fill in your answers in the places provided (After the R#: tag).
- You can add lines in the spaces for your answers but your answers should be brief and straight to the point.

Atenção:
- Não edite este ficheiro em programas como Word e afins. Use exclusivamente um editor de texto simples. Em caso de dúvida, use o editor do Spyder.
- Não altere a estrutura deste ficheiro. Preencha as respostas apenas nos espaços respectivos (a seguir à tag R#:)
- Pode adicionar linhas no espaço para as respostas mas as respostas devem ser sucintas e directas.

Linking images and reports/Incluir imagens e relatórios
- You can link a .png or .html file in your answers by typing the name of the file in a separate line. The file must be in the same folder as this TP1.txt file. See the examples below:
- Pode ligar às respostas um ficheiro .png ou .html escrevendo o nome do ficheiro numa linha separada. O ficheiro tem de estar presente na mesma pasta em que está este ficheiro TP1.txt. Por exemplo:

exemplo.png
exemplo.html

PERGUNTAS/QUESTIONS:

Q1: Explain the architecture of your best model for the multiclass classification problem, including a description and justification of the output activation and loss functions. Also justify your choice of layers and activation functions for the hidden layers.
Q1; Explique a arquitectura do seu melhor modelo para o problema de classificação de multi-classe, incluindo uma descrição e justificação das funções de activação à saída da rede e função de custo. Justifique também a sua escolha de camadas e de funções de activação para as camadas escondidas.
R1:
Convolutional neural networks são largamente usadas para reconhecimento e classificação de imagens, permitindo alcançar excelentes resultados nestes objetivos. Por esse motivo escolhemos implementar uma CNN para o problema da multiclass classification.
Utilizamos a função de ativação "Relu" para as diferentes camadas dados que esta permite evitar problemas como vanishing gradientes, que ocorrem em funções de activação como a sigmoid. Para além disso, a "Relu" também permite um treino mais rápido. Avaliamos com outras variantes da Relu mas a versão normal foi a que produziu melhores resultados, possivelmente porque o nosso modelo não era afetado pelo problema do dying ReLU.
O nosso modelo tem os seguintes componentes:
    1. Uma primeira parte constituída por três blocos com convolutional layers, com 64, 32 e 16 filtros e um kernel (3,3). Estes blocos são constituídos por um stack de duas convolutional layers, com função de ativação Relu e com bath normalization entre elas e terminando com uma camada de MaxPolling.
    2. Após os blocos com convolutional layers fazemos flatten do seu output para que este seja passado adequadamente às Dense layers seguintes.
    3. seguidamente temos 3 dense blocos de 264, 128 e 64 neurónios. Estes blocos são constituídos por uma dense layer com função de ativação Relu, por batch normalization e terminam com uma camada de dropout
    4. Por fim temos a última camada, para output, com 10 neurónios e função de ativação softmax. São 10 neurónios visto que temos 10 classes a que o pokemon na imagem pode pertencer.

O uso da função de activação softmax aplica-se a problemas de classificação em que cada exemplo pode pertencer a uma, e apenas uma das classe, sendo que a função expressão a probabilidade de cada exemplo pertencer a cada classe. Sendo assim podemos concluir a classe prevista pela rede analisando a classe com maior probabilidade. É assim a função de ativação mais adequada para este primeiro problema.

Para a loss function escolhemos categorical_crossentropy dado que é uma loss function que se aplica o problemas de classificação multiclasse, que é o que estamos a avaliar: a qual das 10 classes existentes pertence cada exemplo.

Q2: Discuss and explain how you selected the best model for the multiclass classifcation problem, showing the relevant plots, comparing the different models you tried and evaluating the results you obtained.
Q2: Discuta e explique como selecionou o melhor modelo para o problema de classificação multi-classe, mostrando os gráficos relevantes, comparando os diferentes modelos que experimentou e avaliando os resultados obtidos.
R2:
Para selecionarmos o melhor modelo fizemos uma série de experiências com diferentes arquiteturas, experimentando modelos com mais e menos convolutional layers, alterando o número de filtros e o tamanho do kernel utilizado, adicionando e removendo layers de Dropout e BatchNormalization e experimentando com diferentes otimizadores.
Para otimizadores o SDG, com diferentes valores para o momentum e learning rate e o Adam, com os valores default. Obtivemos sempre melhores resultados, bem como um treino mais rápido com o otimizador Adam pelo que o escolhemos no nosso modelo final.
Em relação aos parâmetros como o número de cada tipo de camada, ao tamanho do kernel a usar e o número de filtros, realizados diferentes experiências e escolhemos a melhor avaliando o erro de validação obtido com cada modelo.
Experimentamos o modelo com e sem BatchNormalization entre as diferentes camadas mas não obtivemos bons resultados. A batch normalization permite fazer re-centering e re-scaling dos inputs das diferentes camadas permitindo que a rede fique mais estável.
Optamos por utilizar camadas de dropout após as dense layers como forma de regularização, evitando o overfitting
Tentamos também uma arquitetura com Residual blocks, que que o input é copiado para o output, mas não obtivemos bons resultados pelo que descartamos este modelo.
Sempre que com modelos diferentes obtínhamos resultados semelhante escolhemos o modelo mais simples, com o menor número de parâmetros. Isto porque modelos mais simples são mais fáceis de treinar e porque modelos complexos podem dificultar a generalização.
A avaliação dos modelos foi feita através do erro de validação e da accuracy medida com os dados de validação. Os modelos que apresentavam piores valores foram descartados.
O modelo selecionado permitiu-nos obter excelentes resultados no teste de treino: Multiclass accuracy: 1.0; Multiclass loss: 0.000170357248862274.
Na imagem images/multiclass-accuracy-best-model.png podemos observar a evolução durante o treino da accuracy de treino e validação, e no ficheiro images/multiclass-loss-best-model.png a evolução da loss, para o modelo selecionado.


Q3: For the multilabel classification problem, explain how you adpated your previous model, what experiments you did to optimize the architecture and discuss your results. Do not forget to explain your choice of activation and loss functions and why this model differs from the previous one.
Q3: Para o problema de classificação com múltiplas etiquetas, explique como adaptou o modelo anterior, que experiências fez para optimizar a arquitectura e discuta os resultados. Não se esqueça de explicar a escolha de funções de activação e custo e porque é que este modelo difere do anterior.
R3:


Q4: Explain the architecture of your best model for the semantic segmentation problem, including a description and justification of the output activation and loss functions. Also justify your choice of layers and activation functions for the hidden layers.
Q4: Explique a arquitectura do seu melhor modelo para o problema de segmentação semântica, incluindo uma descrição e justificação das funções de activação à saída da rede e função de custo. Justifique também a sua escolha de camadas e de funções de activação para as camadas escondidas.
R4:


Q5: Discuss and explain how you selected the best model for the semantic segmentation problem, showing the relevant plots, comparing the different models you tried and evaluating the results you obtained. Use the auxiliary functions provided to show the correspondence between your predicted segmentation masks and the masks provided in the test set.
Q5: Discuta e explique como seleccionou o melhor modelo para o problema de segmentação semântica, mostrando os gráficos relevantes, comparando os diferentes modelos que experimentou e avaliando os resultados obtidos. Use as funções auxiliares fornecidas para mostrar a correspondência entre as máscaras de segmentação previstas e as máscaras no conjunto de teste.
R5:


Q6: (Optional) Discuss the impact on training and overfitting for the two classification problems when using available networks pretrained on ImageNet (e.g. EfficientNetB0, MobileNetV2 or others). Explain how you used these networks and discuss the effect they had relative to your models.
Q6: (Opcional) Discuta o impacto no treino e sobreajustamento nos dois problemas de classificação se usar redes pré-treinadas no dataset ImageNet (e.g. EfficientNetB0, MobileNetV2 or others). Explique como usou estas redes e discuta o efeito que tiveram nos seus modelos.
R6:

